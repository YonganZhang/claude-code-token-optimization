# 上下文成本模型

## 成本分类

以下模型同时适用于 Claude Code 和 OpenClaw。

| 类型 | 固定成本（每轮） | 按需成本 |
|------|-----------------|---------|
| 规则文件 (Rules/TOOLS.md) | 全文 | 无 |
| Skill | 一行 description | 读取时加载全文 |
| 项目说明 (CLAUDE.md/SOUL.md) | 全文 | 无 |
| MCP/工具（无延迟加载） | 所有工具 schema | 调用结果 |
| MCP/工具（有延迟加载） | 工具名列表 | 搜索+调用结果 |

**关键洞察：** 规则文件和项目说明是最贵的，因为每轮都全文加载。Skill 最便宜，只有 description 一行是固定成本。

## 延迟加载

### Claude Code: Tool Search

```json
{ "env": { "ENABLE_TOOL_SEARCH": "true" } }
```

### OpenClaw: 工具默认按需加载

OpenClaw 的 Skills 已经是按需加载的（只看到 name+description），无需额外配置。

## 规则文件精简技巧

规则文件每轮全文加载，必须尽量短：

- 去掉教学性内容，只保留指令
- 去掉代码块格式，用单行内联代码
- 去掉分步说明，AI 本身理解操作方式
- 保留：关键约束值、异常处理提示、易错点

## 规则 vs Skill 选择

| 用规则文件 | 用 Skill |
|---------|---------|
| 每条命令都要遵守（路径规范） | 特定任务才需要（Python 环境） |
| 每次工具调用都要遵守（写入限制） | 特定场景才触发（回滚操作） |
| 每次网络请求都要遵守（代理） | 参考性内容（配置查询） |
